#include <stdio.h>
#include <stdlib.h>


void convolve (double *p_coeffs, int p_coeffs_n,
               double *p_in, double *p_out, int n)
{
    int             i, j, k;
    double          tmp;

    for(k = 0; k < n; k++)                              //  position in output
    {
        tmp = 0;

        for(i = 0; i < p_coeffs_n; i++)                 //  position in coefficients array
        {
            j = k - i;                                  //  position in input

            if(j >= 0)                                  //  bounds check for input buffer
            {
                                    //tmp += p_coeffs[k] * p_in[j];
                //correction_1
                tmp += p_coeffs[i] * p_in[j];
            }

            //p_out[i] = tmp;
            //correction_2
            p_out[k] = tmp;
        }
    }
}


void main(void)
{
    double          coeffs[1485] = { 4.345331372379e-06,9.682442947214e-06,1.891968507852e-05,3.191671077635e-05,
                                     4.808937845749e-05,6.563153229694e-05,8.125683052374e-05,9.013469565037e-05,
                                    8.613504869311e-05,6.243007455834e-05,1.246431988585e-05,-6.876515442398e-05,
                                    -0.0001832620506729,-0.0003286459651701,-0.0004970573466876,-0.0006746823922129,
                                    -0.0008420885489216,-0.0009755537841608,-0.001049386993539,-0.001039093935689,
                                    -0.0009250581335257,-0.0006962508588547,-0.000353405173537,  8.8947063252e-05,
                                    0.0006020669743476, 0.001144561903751, 0.001665952970341, 0.002111998106369,
                                     0.002431206543499, 0.002581714772893, 0.002537541844314, 0.002293230287238,
                                      0.00186602466594, 0.001295051358403,0.0006373715864138,-3.872396092789e-05,
                                    -0.0006623702986692,-0.001169538375885,-0.001511826055375,-0.001663256730551,
                                    -0.001623961443645,-0.001420055921358,-0.001099608951387,-0.0007252196420853,
                                    -0.0003642971407877,-7.854414272299e-05,8.566835184537e-05,0.0001044592205731,
                                    -2.008758458268e-05,-0.0002607395552216,-0.0005701318900668,-0.0008891610349995,
                                    -0.001157347577534,-0.001323391100114,-0.001354088133559, -0.00124004449535,
                                    -0.0009971666250504,-0.0006636538349448,-0.0002930195968589, 5.56155402041e-05,
                                    0.0003282057000206,0.0004854994167031,0.0005100143552687,0.0004089850776529,
                                    0.0002127320426417,-3.124751751309e-05,-0.0002673703121386,-0.0004425367037542,
                                    -0.0005161910429108,-0.0004679690542955,-0.000301477300728,-4.347843877502e-05,
                                    0.0002613667455837,0.0005591984335324,0.0007974237005149,0.0009349283531026,
                                    0.0009500490175811,0.0008447477629541,0.0006441619049575,0.0003916042775747,
                                    0.0001399824813245,-5.868361063401e-05,-0.000163579614124,-0.0001532040422132,
                                    -2.96445894029e-05, 0.000181845898834,0.0004379109652337,0.0006858004109417,
                                    0.0008740000484465,0.0009626552997311,0.0009316865435752,0.0007849436300209,
                                     0.000549533236289,0.0002704216301839,1.375483194334e-06,-0.0002059452994044,
                                    -0.0003125346614285,-0.0003000732681895,-0.0001747847368322,3.370958085957e-05,
                                    0.0002783467440516,0.0005042110359378,0.0006598187507618,0.0007077936410805,
                                    0.0006327272810939,0.0004445740424989,0.0001768334664579,-0.0001201604594346,
                                    -0.0003895071833991,-0.0005794775969996,-0.0006543043698517,-0.0006017738064767,
                                    -0.0004360038474013,-0.0001947721826955,6.811587039012e-05,0.0002938922851619,
                                    0.0004310600057746,0.0004462581620074,0.0003314720023919,0.0001060324715514,
                                    -0.0001870826625516,-0.0004899497792446,-0.000741649619311,-0.0008910082732371,
                                    -0.0009074692210529,-0.0007877887989805,-0.0005570901547066,-0.000263971404263,
                                    2.939068224616e-05,0.0002601362684532,0.0003779495006353,0.0003558395183148,
                                    0.0001961683268826, -6.9416260865e-05,-0.0003862228381087,-0.0006877135980358,
                                    -0.0009093733985677,-0.001002366874768,-0.0009440991720216,-0.0007434009686073,
                                    -0.0004391579647153,-9.256788779452e-05,0.0002254408911604,0.0004490492907186,
                                    0.0005315445738738,0.0004555014958376,0.0002369307022671,-7.758209526058e-05,
                                    -0.0004202568690071,-0.0007161414784416,-0.0008988836871192,-0.0009249407579711,
                                    -0.0007831910721444,-0.0004978331504833,-0.000123846053252,0.0002641522549049,
                                    0.0005873962955026,0.0007796028763612,0.0008012302628769,0.0006483020355387,
                                    0.0003538308808824,-1.858465887674e-05,-0.0003877641158384,-0.0006719000908325,
                                    -0.0008059314753837,-0.0007556514474266,-0.0005254987065655,-0.0001582687508785,
                                    0.0002733299582824,0.0006816196419985,0.0009823301151759, 0.001112561165072,
                                     0.001044504024258,0.0007919325587826,0.0004079609260371,-2.560312850515e-05,
                                    -0.0004151871866309,-0.0006751696071051,-0.0007462340667407,-0.0006084339151453,
                                    -0.0002860970276917,0.0001566110137828,0.0006286779512302, 0.001031168817732,
                                     0.001278153081406, 0.001315212498788, 0.001131547479004, 0.000762996300355,
                                    0.0002851719530712,-0.0002019863157971,-0.0005950989387389,-0.0008093097834312,
                                    -0.000796665771825,-0.0005569357931954,-0.0001384382493627,0.0003714647369699,
                                    0.0008643505484376, 0.001233503023257, 0.001396687989684, 0.001314081650421,
                                    0.0009974496113609,0.0005084762830575,-5.357609880389e-05,-0.0005724203719733,
                                    -0.0009392590363735,-0.001076095415675,-0.0009528495715127,-0.0005945273902264,
                                    -7.675376746783e-05,0.0004895638778318,0.0009813429253544, 0.001289396923484,
                                     0.001341954221749, 0.001120564110701,0.0006648748887237,6.508843670933e-05,
                                    -0.0005564922044596,-0.001071054088213,-0.001370653082748,-0.001391562092812,
                                    -0.001128541189183,-0.0006368411929092,-2.132336125102e-05,0.0005851804108588,
                                     0.001049810451917, 0.001268054038619, 0.001186497482376,0.0008150098849672,
                                    0.0002255947244241,-0.0004620473859209,-0.001105361676349,-0.001569036405508,
                                     -0.00175400275415, -0.00161912357593,-0.001190827353098,-0.0005584483173973,
                                    0.0001439432616479,0.0007655377021321, 0.001170769974083, 0.001268513413503,
                                     0.001032201032105,0.0005064404034226,-0.0002014896242865,-0.0009436618654676,
                                    -0.001562531226275,-0.001924467320242,-0.001948655507723,-0.001625118989326,
                                    -0.001017852632642,-0.0002521852449532,0.0005111508114782, 0.001109885656024,
                                     0.001414881796844, 0.001358203743949,0.0009484899244415,0.0002701612643322,
                                    -0.000533590228003, -0.00129061859342,-0.001836245516335,-0.002048584582829,
                                    -0.001875195618907,-0.001345246482159,-0.000564382382017,0.0003068353392911,
                                     0.001086529607922, 0.001610119776236, 0.001765749321384, 0.001518904455472,
                                    0.0009208096178002,9.858702331496e-05,-0.0007709560353994,-0.001498517530747,
                                    -0.001922652892536,-0.001944691986037,-0.001550675182064,-0.0008154425508098,
                                    0.0001122309627509, 0.001040517595229, 0.001775030379245,  0.00216038179859,
                                     0.002113922134869, 0.001644333461458,0.0008509047131742,-9.660141745167e-05,
                                    -0.0009934234294868,-0.001643212944959,-0.001900185793336,-0.001700968223983,
                                    -0.001079189251846,-0.0001594793484251,0.0008680932163454, 0.001787913441632,
                                     0.002404668334624, 0.002585404575132, 0.002288738925084, 0.001574807995773,
                                    0.0005935929016581,-0.0004461396927864,-0.001320858281378, -0.00183997160045,
                                    -0.001887040685785,-0.001445590174242,-0.0006038065960022,0.0004631314988595,
                                     0.001529566788037, 0.002367115170603, 0.002793553630701, 0.002712380375676,
                                     0.002134461412424, 0.001176919053407,3.924022520575e-05, -0.00103853367742,
                                    -0.001826777436193,-0.002155591171754, -0.00195186042808, -0.00125598586926,
                                    -0.0002144700967079,0.0009503175975666, 0.001986969086963, 0.002668602021508,
                                      0.00284175153306, 0.002460056500582, 0.001595352595071,0.0004235494348108,
                                    -0.0008119524329488, -0.00185170174834,-0.002475623541818, -0.00255059016998,
                                    -0.002059852828534,-0.001107830461419, 0.000101029713066, 0.001305058643802,
                                     0.002240884615021, 0.002699890977231, 0.002573513660378, 0.001877548921665,
                                    0.0007500421603593,-0.0005770589720175,-0.001826674625927,-0.002735531904204,
                                    -0.003110734142305,-0.002871802146432,-0.002069024578582,-0.0008739449352135,
                                    0.0004562501437122, 0.001633059945382, 0.002398245023068, 0.002579510602505,
                                     0.002128294486457, 0.001131379443732,-0.0002064144487167,-0.001605021927524,
                                     -0.00276847261325,-0.003448204817983,-0.003496806933572,-0.002900564928563,
                                    -0.001783633634375,-0.0003826709977492, 0.001002896592071,  0.00207453220698,
                                     0.002598637812542, 0.002457255068064, 0.001674415183468,0.0004122620849837,
                                    -0.001062493329978,-0.002434855884947,-0.003408691504883,-0.003770421724268,
                                    -0.003435567104141,-0.002467998275278,-0.001067522792221, 0.000471805857882,
                                     0.001823963934341, 0.002700630109257, 0.002913364012486, 0.002414880027417,
                                     0.001310377474786,-0.0001637598296038,-0.001689599553642, -0.00293521632799,
                                    -0.003625815757343,-0.003603188299287,-0.002860632919588,-0.001545649622221,
                                    7.044278500741e-05,  0.00164971288912, 0.002859584344515, 0.003444234613301,
                                     0.003280091211696, 0.002403383086331, 0.001003607933794,-0.0006159530607778,
                                    -0.002102456747331,-0.003128861605415,-0.003464339631569,-0.003024579142051,
                                    -0.001891021725832,-0.0002946626228753, 0.001432379045228, 0.002927367525541,
                                     0.003874562676897, 0.004073325177462, 0.003482018127696, 0.002228096719986,
                                    0.0005819672659647,-0.001100038712193,-0.002451556713167,-0.003174787484014,
                                    -0.003104941519018,-0.002246586577318,-0.0007738894197834, 0.001005559696673,
                                     0.002715830242526, 0.003992869897638, 0.004562735986149, 0.004301023776734,
                                     0.003260595825549, 0.001661436488953,-0.0001554514626586,-0.001800452523702,
                                    -0.002918674442326,-0.003266388398387,-0.002764107866307,-0.001514747417613,
                                    0.0002172723504576, 0.002061745395908, 0.003621487071148, 0.004557450780663,
                                     0.004661911161593, 0.003903915605987, 0.002437060658548,0.0005676809809041,
                                    -0.001309968684605,-0.002797823233067,-0.003579461538691,-0.003488555149946,
                                    -0.002545500250921,-0.0009541650322418,0.0009407946734617, 0.002727123477834,
                                      0.00401311995236, 0.004511907141239, 0.004103690709415, 0.002862496714232,
                                     0.001041431983985,-0.0009806115592646,-0.002779585273165,-0.003977080832908,
                                    -0.004321846679895,-0.003744454866781,-0.002373218126845,-0.000507715178236,
                                     0.001444627678505, 0.003055480808778, 0.003967530920756, 0.003971652865917,
                                     0.003052668739588, 0.001393688681401,-0.0006621267899719,-0.002684397825673,
                                    -0.004247486967367,-0.005021932724826,-0.004845704490761,-0.003759859305955,
                                    -0.002000750580569,4.976507411729e-05, 0.001945641090368, 0.003272163754706,
                                     0.003735229509129, 0.003225159302642, 0.001841206289199,-0.0001287081812492,
                                    -0.002268900528867,-0.004124586186617,-0.005299380027997,-0.005540725535126,
                                    -0.004794834414567,-0.003219181116541,-0.001149662409984, 0.000970737857765,
                                     0.002686630971548, 0.003628014681835, 0.003590170983213, 0.002578415579801,
                                    0.0008079180545528,-0.001341575558808,-0.003406593747807,-0.004939149181771,
                                    -0.005603068128846,-0.005246723185692,-0.003936432428872,-0.001943172182906,
                                    0.0003147461460212, 0.002360907960898, 0.003762896415651, 0.004225374343881,
                                     0.003654102756452, 0.002177013419659,0.0001176246925097,-0.002073685603631,
                                    -0.003915955190763,-0.005000882256283,-0.005080879423333,-0.004122949566785,
                                    -0.002316665832028,-3.435546033883e-05, 0.002248146330082,  0.00405329784244,
                                      0.00500441739962, 0.004906974664097, 0.003791052694058, 0.001905705148193,
                                    -0.0003337635218131,-0.002434443649606,-0.003931476616185,-0.004488078351829,
                                    -0.003968412863164,-0.002467553341782,-0.0002919340657581, 0.002105687289439,
                                     0.004222944834814, 0.005615587126082, 0.005993096420819, 0.005281613095628,
                                     0.003640527006507,  0.00142900824376,-0.0008705048745577,-0.002755567025313,
                                    -0.003811638354513,-0.003801474314502,-0.002716721515189,-0.0007805047667861,
                                     0.001599714207781, 0.003919042203887, 0.005683280984177, 0.006515111105461,
                                     0.006235510672138, 0.004902835127372, 0.002801025007091,0.0003793135205031,
                                    -0.001843765692976,-0.003391558285605,-0.003931817201438,-0.003348523950822,
                                    -0.001767478446518,0.0004699824082621, 0.002879648988584, 0.004938016514754,
                                     0.006194617610006, 0.006369005199364, 0.005411506462559, 0.003514590695455,
                                     0.001072263897352,-0.001403939247671,-0.003394447925948,-0.004483187887366,
                                    -0.004447205389112,-0.003305070712225,-0.001313549285365, 0.001086890718142,
                                     0.003366174727479,  0.00501822567163, 0.005669733610431, 0.005160721462562,
                                      0.00357952939553, 0.001244581859121,-0.001363292919967,-0.003703593243122,
                                    -0.005291963115122,-0.005804270373317,-0.005146569627592,-0.003475840365954,
                                    -0.001166918834721, 0.001267420190142, 0.003286200602013, 0.004436326394992,
                                     0.004450110040179,  0.00330326930288, 0.001220843669861,-0.001370373504439,
                                     -0.00393281835903,-0.005933145014472,-0.006956610122477,-0.006796311824975,
                                    -0.005498075289836,-0.003351243205754,-0.0008272095997779, 0.001521252169022,
                                      0.00317837488089,  0.00377615276569,  0.00317369625696, 0.001488091075824,
                                    -0.0009299779779801,-0.003570751967718,-0.005874222195393,-0.007350012908834,
                                    -0.007682654556346,-0.006799647536129,-0.004887635720851,-0.002353091805918,
                                    0.0002642025558649, 0.002406465635291,  0.00361738417249, 0.003640161160312,
                                     0.002473086650847, 0.000370620638971,-0.002210385491369,-0.004707956431673,
                                    -0.006575038586315,-0.007396684823642,-0.006979287741893, -0.00539268886418,
                                    -0.002956026877035,-0.0001702014736355, 0.002388742319913, 0.004192609229825,
                                     0.004874165680034, 0.004306151597262, 0.002629201756558,0.0002225638644169,
                                    -0.002376289588138,-0.004586119905947,-0.005906089952884,-0.006023138475872,
                                    -0.004879573036463,-0.002686324878806, 0.000121128635211, 0.002974937882699,
                                      0.00529562185856, 0.006615694477575, 0.006679803002053, 0.005499937984513,
                                     0.003353791021835,0.0007264234101526,-0.001792506321606,-0.003634197166981,
                                    -0.004372182166805,-0.003813927080527,-0.002042930883881,0.0005978186734745,
                                     0.003577727594253, 0.006290722012953,  0.00818390868887, 0.008875459636896,
                                     0.008236602864466, 0.006420139497164, 0.003829204553085, 0.001032660013375,
                                    -0.001355133068296,-0.002804783066693,-0.002984920944716,-0.001833761754211,
                                     0.000426203323863, 0.003333772836313, 0.006285491501127, 0.008662807660416,
                                     0.009963147101643, 0.009907163656923, 0.008499332438802, 0.006028806291488,
                                     0.003010016655794,7.522950138688e-05,-0.002158521701825, -0.00322017164924,
                                    -0.002885408262051,-0.001226043192137, 0.001402787067851, 0.004435315229259,
                                      0.00721283403665,  0.00912192269265, 0.009724266354721, 0.008850695256328,
                                     0.006639390325773, 0.003509774415793,7.703205213267e-05,-0.002975318172431,
                                    -0.005038451763291,-0.005707038497872,-0.004866708455346,-0.002721475262483,
                                    0.0002452269511466, 0.003368450140993, 0.005938784108499, 0.007350407621665,
                                     0.007229412969964,  0.00551544780747, 0.002479108168512, -0.00132936289061,
                                    -0.005190341780041,-0.008362006552715, -0.01023447450946, -0.01045909996518,
                                    -0.009025818225008,-0.006271727030011,-0.002817982273228,0.0005532458001595,
                                      0.00305753433759, 0.004070751446739, 0.003262116164286,0.0006699210652864,
                                    -0.003296787613507,-0.007932557100799, -0.01237250723756, -0.01576558240098,
                                     -0.01744980594541,  -0.0170940704361, -0.01477687129881,  -0.0109842942503,
                                    -0.006525256132413,-0.002378449552929,0.0005005630037338,   0.0013749151656,
                                    -0.0001142049453359,  -0.0038573959634,-0.009276613184072, -0.01541818774242,
                                     -0.02112497980258,  -0.0252574932743, -0.02692316725626, -0.02566982928767,
                                     -0.02160425458412, -0.01540922183902,-0.008250297130675,-0.001583682536126,
                                     0.003104767786921,  0.00458527479792, 0.002143956770882, -0.00423165205946,
                                     -0.01377888376021, -0.02501764269541, -0.03593724465161, -0.04428783109528,
                                     -0.04793299667276,  -0.0452082120095,  -0.0352265109184, -0.01807945263893,
                                     0.005103329882477,  0.03225100222017,  0.06059522455187,   0.0870275391605,
                                       0.1085186951665,   0.1225375283283,   0.1274061713118,   0.1225375283283,
                                       0.1085186951665,   0.0870275391605,  0.06059522455187,  0.03225100222017,
                                     0.005103329882477, -0.01807945263893,  -0.0352265109184,  -0.0452082120095,
                                     -0.04793299667276, -0.04428783109528, -0.03593724465161, -0.02501764269541,
                                     -0.01377888376021, -0.00423165205946, 0.002143956770882,  0.00458527479792,
                                     0.003104767786921,-0.001583682536126,-0.008250297130675, -0.01540922183902,
                                     -0.02160425458412, -0.02566982928767, -0.02692316725626,  -0.0252574932743,
                                     -0.02112497980258, -0.01541818774242,-0.009276613184072,  -0.0038573959634,
                                    -0.0001142049453359,   0.0013749151656,0.0005005630037338,-0.002378449552929,
                                    -0.006525256132413,  -0.0109842942503, -0.01477687129881,  -0.0170940704361,
                                     -0.01744980594541, -0.01576558240098, -0.01237250723756,-0.007932557100799,
                                    -0.003296787613507,0.0006699210652864, 0.003262116164286, 0.004070751446739,
                                      0.00305753433759,0.0005532458001595,-0.002817982273228,-0.006271727030011,
                                    -0.009025818225008, -0.01045909996518, -0.01023447450946,-0.008362006552715,
                                    -0.005190341780041, -0.00132936289061, 0.002479108168512,  0.00551544780747,
                                     0.007229412969964, 0.007350407621665, 0.005938784108499, 0.003368450140993,
                                    0.0002452269511466,-0.002721475262483,-0.004866708455346,-0.005707038497872,
                                    -0.005038451763291,-0.002975318172431,7.703205213267e-05, 0.003509774415793,
                                     0.006639390325773, 0.008850695256328, 0.009724266354721,  0.00912192269265,
                                      0.00721283403665, 0.004435315229259, 0.001402787067851,-0.001226043192137,
                                    -0.002885408262051, -0.00322017164924,-0.002158521701825,7.522950138688e-05,
                                     0.003010016655794, 0.006028806291488, 0.008499332438802, 0.009907163656923,
                                     0.009963147101643, 0.008662807660416, 0.006285491501127, 0.003333772836313,
                                     0.000426203323863,-0.001833761754211,-0.002984920944716,-0.002804783066693,
                                    -0.001355133068296, 0.001032660013375, 0.003829204553085, 0.006420139497164,
                                     0.008236602864466, 0.008875459636896,  0.00818390868887, 0.006290722012953,
                                     0.003577727594253,0.0005978186734745,-0.002042930883881,-0.003813927080527,
                                    -0.004372182166805,-0.003634197166981,-0.001792506321606,0.0007264234101526,
                                     0.003353791021835, 0.005499937984513, 0.006679803002053, 0.006615694477575,
                                      0.00529562185856, 0.002974937882699, 0.000121128635211,-0.002686324878806,
                                    -0.004879573036463,-0.006023138475872,-0.005906089952884,-0.004586119905947,
                                    -0.002376289588138,0.0002225638644169, 0.002629201756558, 0.004306151597262,
                                     0.004874165680034, 0.004192609229825, 0.002388742319913,-0.0001702014736355,
                                    -0.002956026877035, -0.00539268886418,-0.006979287741893,-0.007396684823642,
                                    -0.006575038586315,-0.004707956431673,-0.002210385491369, 0.000370620638971,
                                     0.002473086650847, 0.003640161160312,  0.00361738417249, 0.002406465635291,
                                    0.0002642025558649,-0.002353091805918,-0.004887635720851,-0.006799647536129,
                                    -0.007682654556346,-0.007350012908834,-0.005874222195393,-0.003570751967718,
                                    -0.0009299779779801, 0.001488091075824,  0.00317369625696,  0.00377615276569,
                                      0.00317837488089, 0.001521252169022,-0.0008272095997779,-0.003351243205754,
                                    -0.005498075289836,-0.006796311824975,-0.006956610122477,-0.005933145014472,
                                     -0.00393281835903,-0.001370373504439, 0.001220843669861,  0.00330326930288,
                                     0.004450110040179, 0.004436326394992, 0.003286200602013, 0.001267420190142,
                                    -0.001166918834721,-0.003475840365954,-0.005146569627592,-0.005804270373317,
                                    -0.005291963115122,-0.003703593243122,-0.001363292919967, 0.001244581859121,
                                      0.00357952939553, 0.005160721462562, 0.005669733610431,  0.00501822567163,
                                     0.003366174727479, 0.001086890718142,-0.001313549285365,-0.003305070712225,
                                    -0.004447205389112,-0.004483187887366,-0.003394447925948,-0.001403939247671,
                                     0.001072263897352, 0.003514590695455, 0.005411506462559, 0.006369005199364,
                                     0.006194617610006, 0.004938016514754, 0.002879648988584,0.0004699824082621,
                                    -0.001767478446518,-0.003348523950822,-0.003931817201438,-0.003391558285605,
                                    -0.001843765692976,0.0003793135205031, 0.002801025007091, 0.004902835127372,
                                     0.006235510672138, 0.006515111105461, 0.005683280984177, 0.003919042203887,
                                     0.001599714207781,-0.0007805047667861,-0.002716721515189,-0.003801474314502,
                                    -0.003811638354513,-0.002755567025313,-0.0008705048745577,  0.00142900824376,
                                     0.003640527006507, 0.005281613095628, 0.005993096420819, 0.005615587126082,
                                     0.004222944834814, 0.002105687289439,-0.0002919340657581,-0.002467553341782,
                                    -0.003968412863164,-0.004488078351829,-0.003931476616185,-0.002434443649606,
                                    -0.0003337635218131, 0.001905705148193, 0.003791052694058, 0.004906974664097,
                                      0.00500441739962,  0.00405329784244, 0.002248146330082,-3.435546033883e-05,
                                    -0.002316665832028,-0.004122949566785,-0.005080879423333,-0.005000882256283,
                                    -0.003915955190763,-0.002073685603631,0.0001176246925097, 0.002177013419659,
                                     0.003654102756452, 0.004225374343881, 0.003762896415651, 0.002360907960898,
                                    0.0003147461460212,-0.001943172182906,-0.003936432428872,-0.005246723185692,
                                    -0.005603068128846,-0.004939149181771,-0.003406593747807,-0.001341575558808,
                                    0.0008079180545528, 0.002578415579801, 0.003590170983213, 0.003628014681835,
                                     0.002686630971548, 0.000970737857765,-0.001149662409984,-0.003219181116541,
                                    -0.004794834414567,-0.005540725535126,-0.005299380027997,-0.004124586186617,
                                    -0.002268900528867,-0.0001287081812492, 0.001841206289199, 0.003225159302642,
                                     0.003735229509129, 0.003272163754706, 0.001945641090368,4.976507411729e-05,
                                    -0.002000750580569,-0.003759859305955,-0.004845704490761,-0.005021932724826,
                                    -0.004247486967367,-0.002684397825673,-0.0006621267899719, 0.001393688681401,
                                     0.003052668739588, 0.003971652865917, 0.003967530920756, 0.003055480808778,
                                     0.001444627678505,-0.000507715178236,-0.002373218126845,-0.003744454866781,
                                    -0.004321846679895,-0.003977080832908,-0.002779585273165,-0.0009806115592646,
                                     0.001041431983985, 0.002862496714232, 0.004103690709415, 0.004511907141239,
                                      0.00401311995236, 0.002727123477834,0.0009407946734617,-0.0009541650322418,
                                    -0.002545500250921,-0.003488555149946,-0.003579461538691,-0.002797823233067,
                                    -0.001309968684605,0.0005676809809041, 0.002437060658548, 0.003903915605987,
                                     0.004661911161593, 0.004557450780663, 0.003621487071148, 0.002061745395908,
                                    0.0002172723504576,-0.001514747417613,-0.002764107866307,-0.003266388398387,
                                    -0.002918674442326,-0.001800452523702,-0.0001554514626586, 0.001661436488953,
                                     0.003260595825549, 0.004301023776734, 0.004562735986149, 0.003992869897638,
                                     0.002715830242526, 0.001005559696673,-0.0007738894197834,-0.002246586577318,
                                    -0.003104941519018,-0.003174787484014,-0.002451556713167,-0.001100038712193,
                                    0.0005819672659647, 0.002228096719986, 0.003482018127696, 0.004073325177462,
                                     0.003874562676897, 0.002927367525541, 0.001432379045228,-0.0002946626228753,
                                    -0.001891021725832,-0.003024579142051,-0.003464339631569,-0.003128861605415,
                                    -0.002102456747331,-0.0006159530607778, 0.001003607933794, 0.002403383086331,
                                     0.003280091211696, 0.003444234613301, 0.002859584344515,  0.00164971288912,
                                    7.044278500741e-05,-0.001545649622221,-0.002860632919588,-0.003603188299287,
                                    -0.003625815757343, -0.00293521632799,-0.001689599553642,-0.0001637598296038,
                                     0.001310377474786, 0.002414880027417, 0.002913364012486, 0.002700630109257,
                                     0.001823963934341, 0.000471805857882,-0.001067522792221,-0.002467998275278,
                                    -0.003435567104141,-0.003770421724268,-0.003408691504883,-0.002434855884947,
                                    -0.001062493329978,0.0004122620849837, 0.001674415183468, 0.002457255068064,
                                     0.002598637812542,  0.00207453220698, 0.001002896592071,-0.0003826709977492,
                                    -0.001783633634375,-0.002900564928563,-0.003496806933572,-0.003448204817983,
                                     -0.00276847261325,-0.001605021927524,-0.0002064144487167, 0.001131379443732,
                                     0.002128294486457, 0.002579510602505, 0.002398245023068, 0.001633059945382,
                                    0.0004562501437122,-0.0008739449352135,-0.002069024578582,-0.002871802146432,
                                    -0.003110734142305,-0.002735531904204,-0.001826674625927,-0.0005770589720175,
                                    0.0007500421603593, 0.001877548921665, 0.002573513660378, 0.002699890977231,
                                     0.002240884615021, 0.001305058643802, 0.000101029713066,-0.001107830461419,
                                    -0.002059852828534, -0.00255059016998,-0.002475623541818, -0.00185170174834,
                                    -0.0008119524329488,0.0004235494348108, 0.001595352595071, 0.002460056500582,
                                      0.00284175153306, 0.002668602021508, 0.001986969086963,0.0009503175975666,
                                    -0.0002144700967079, -0.00125598586926, -0.00195186042808,-0.002155591171754,
                                    -0.001826777436193, -0.00103853367742,3.924022520575e-05, 0.001176919053407,
                                     0.002134461412424, 0.002712380375676, 0.002793553630701, 0.002367115170603,
                                     0.001529566788037,0.0004631314988595,-0.0006038065960022,-0.001445590174242,
                                    -0.001887040685785, -0.00183997160045,-0.001320858281378,-0.0004461396927864,
                                    0.0005935929016581, 0.001574807995773, 0.002288738925084, 0.002585404575132,
                                     0.002404668334624, 0.001787913441632,0.0008680932163454,-0.0001594793484251,
                                    -0.001079189251846,-0.001700968223983,-0.001900185793336,-0.001643212944959,
                                    -0.0009934234294868,-9.660141745167e-05,0.0008509047131742, 0.001644333461458,
                                     0.002113922134869,  0.00216038179859, 0.001775030379245, 0.001040517595229,
                                    0.0001122309627509,-0.0008154425508098,-0.001550675182064,-0.001944691986037,
                                    -0.001922652892536,-0.001498517530747,-0.0007709560353994,9.858702331496e-05,
                                    0.0009208096178002, 0.001518904455472, 0.001765749321384, 0.001610119776236,
                                     0.001086529607922,0.0003068353392911,-0.000564382382017,-0.001345246482159,
                                    -0.001875195618907,-0.002048584582829,-0.001836245516335, -0.00129061859342,
                                    -0.000533590228003,0.0002701612643322,0.0009484899244415, 0.001358203743949,
                                     0.001414881796844, 0.001109885656024,0.0005111508114782,-0.0002521852449532,
                                    -0.001017852632642,-0.001625118989326,-0.001948655507723,-0.001924467320242,
                                    -0.001562531226275,-0.0009436618654676,-0.0002014896242865,0.0005064404034226,
                                     0.001032201032105, 0.001268513413503, 0.001170769974083,0.0007655377021321,
                                    0.0001439432616479,-0.0005584483173973,-0.001190827353098, -0.00161912357593,
                                     -0.00175400275415,-0.001569036405508,-0.001105361676349,-0.0004620473859209,
                                    0.0002255947244241,0.0008150098849672, 0.001186497482376, 0.001268054038619,
                                     0.001049810451917,0.0005851804108588,-2.132336125102e-05,-0.0006368411929092,
                                    -0.001128541189183,-0.001391562092812,-0.001370653082748,-0.001071054088213,
                                    -0.0005564922044596,6.508843670933e-05,0.0006648748887237, 0.001120564110701,
                                     0.001341954221749, 0.001289396923484,0.0009813429253544,0.0004895638778318,
                                    -7.675376746783e-05,-0.0005945273902264,-0.0009528495715127,-0.001076095415675,
                                    -0.0009392590363735,-0.0005724203719733,-5.357609880389e-05,0.0005084762830575,
                                    0.0009974496113609, 0.001314081650421, 0.001396687989684, 0.001233503023257,
                                    0.0008643505484376,0.0003714647369699,-0.0001384382493627,-0.0005569357931954,
                                    -0.000796665771825,-0.0008093097834312,-0.0005950989387389,-0.0002019863157971,
                                    0.0002851719530712, 0.000762996300355, 0.001131547479004, 0.001315212498788,
                                     0.001278153081406, 0.001031168817732,0.0006286779512302,0.0001566110137828,
                                    -0.0002860970276917,-0.0006084339151453,-0.0007462340667407,-0.0006751696071051,
                                    -0.0004151871866309,-2.560312850515e-05,0.0004079609260371,0.0007919325587826,
                                     0.001044504024258, 0.001112561165072,0.0009823301151759,0.0006816196419985,
                                    0.0002733299582824,-0.0001582687508785,-0.0005254987065655,-0.0007556514474266,
                                    -0.0008059314753837,-0.0006719000908325,-0.0003877641158384,-1.858465887674e-05,
                                    0.0003538308808824,0.0006483020355387,0.0008012302628769,0.0007796028763612,
                                    0.0005873962955026,0.0002641522549049,-0.000123846053252,-0.0004978331504833,
                                    -0.0007831910721444,-0.0009249407579711,-0.0008988836871192,-0.0007161414784416,
                                    -0.0004202568690071,-7.758209526058e-05,0.0002369307022671,0.0004555014958376,
                                    0.0005315445738738,0.0004490492907186,0.0002254408911604,-9.256788779452e-05,
                                    -0.0004391579647153,-0.0007434009686073,-0.0009440991720216,-0.001002366874768,
                                    -0.0009093733985677,-0.0006877135980358,-0.0003862228381087, -6.9416260865e-05,
                                    0.0001961683268826,0.0003558395183148,0.0003779495006353,0.0002601362684532,
                                    2.939068224616e-05,-0.000263971404263,-0.0005570901547066,-0.0007877887989805,
                                    -0.0009074692210529,-0.0008910082732371,-0.000741649619311,-0.0004899497792446,
                                    -0.0001870826625516,0.0001060324715514,0.0003314720023919,0.0004462581620074,
                                    0.0004310600057746,0.0002938922851619,6.811587039012e-05,-0.0001947721826955,
                                    -0.0004360038474013,-0.0006017738064767,-0.0006543043698517,-0.0005794775969996,
                                    -0.0003895071833991,-0.0001201604594346,0.0001768334664579,0.0004445740424989,
                                    0.0006327272810939,0.0007077936410805,0.0006598187507618,0.0005042110359378,
                                    0.0002783467440516,3.370958085957e-05,-0.0001747847368322,-0.0003000732681895,
                                    -0.0003125346614285,-0.0002059452994044,1.375483194334e-06,0.0002704216301839,
                                     0.000549533236289,0.0007849436300209,0.0009316865435752,0.0009626552997311,
                                    0.0008740000484465,0.0006858004109417,0.0004379109652337, 0.000181845898834,
                                    -2.96445894029e-05,-0.0001532040422132,-0.000163579614124,-5.868361063401e-05,
                                    0.0001399824813245,0.0003916042775747,0.0006441619049575,0.0008447477629541,
                                    0.0009500490175811,0.0009349283531026,0.0007974237005149,0.0005591984335324,
                                    0.0002613667455837,-4.347843877502e-05,-0.000301477300728,-0.0004679690542955,
                                    -0.0005161910429108,-0.0004425367037542,-0.0002673703121386,-3.124751751309e-05,
                                    0.0002127320426417,0.0004089850776529,0.0005100143552687,0.0004854994167031,
                                    0.0003282057000206, 5.56155402041e-05,-0.0002930195968589,-0.0006636538349448,
                                    -0.0009971666250504, -0.00124004449535,-0.001354088133559,-0.001323391100114,
                                    -0.001157347577534,-0.0008891610349995,-0.0005701318900668,-0.0002607395552216,
                                    -2.008758458268e-05,0.0001044592205731,8.566835184537e-05,-7.854414272299e-05,
                                    -0.0003642971407877,-0.0007252196420853,-0.001099608951387,-0.001420055921358,
                                    -0.001623961443645,-0.001663256730551,-0.001511826055375,-0.001169538375885,
                                    -0.0006623702986692,-3.872396092789e-05,0.0006373715864138, 0.001295051358403,
                                      0.00186602466594, 0.002293230287238, 0.002537541844314, 0.002581714772893,
                                     0.002431206543499, 0.002111998106369, 0.001665952970341, 0.001144561903751,
                                    0.0006020669743476,  8.8947063252e-05,-0.000353405173537,-0.0006962508588547,
                                    -0.0009250581335257,-0.001039093935689,-0.001049386993539,-0.0009755537841608,
                                    -0.0008420885489216,-0.0006746823922129,-0.0004970573466876,-0.0003286459651701,
                                    -0.0001832620506729,-6.876515442398e-05,1.246431988585e-05,6.243007455834e-05,
                                    8.613504869311e-05,9.013469565037e-05,8.125683052374e-05,6.563153229694e-05,
                                    4.808937845749e-05,3.191671077635e-05,1.891968507852e-05,9.682442947214e-06,
                                    4.345331372379e-06
    };

    FILE *fp;
    FILE *fpw;

    short       int *in, *out;
    double          *in_double, *out_rezult;

    unsigned    int i;

    unsigned    int size_input_file;


    if((fp=fopen("C:\\Users\\Sergei\\Desktop\\filter\\muzic.bin", "rb"))==NULL)
//    if((fp=fopen("D:\\Projects\\Lab_6\\Hardware\\src\\filter\\muzic.bin", "rb"))==NULL)
    {
        printf ("Cannot open file.\n");
        exit(1);
    }


    fseek(fp, 0, SEEK_END);                             // seek to end of file
    size_input_file = ftell(fp);                        // get current file pointer
    fseek(fp, 0, SEEK_SET);                             // seek back to beginning of file



    // proceed with allocating memory and reading the file

    in = malloc(size_input_file);
    in_double = malloc(sizeof(double) * (size_input_file/2));

    out = malloc(size_input_file);
    out_rezult = malloc(sizeof(double) * (size_input_file/2));




    if(fread(in, sizeof(short int), size_input_file/2, fp) != size_input_file/2)
    {
        if(feof(fp))
            printf("Premature end of file.");
        else
            printf("File read error.");
    }



    for(i=0; i < size_input_file/2; i++)
        in_double[i] = (double) in[i];




    for(i=0; i < size_input_file/2; i++)
        out_rezult[i] = 1;





    //convolve(coeffs, size_input_file / 2 - 1, in_double, out_rezult, 1484);
    //correction_3
    convolve(coeffs, (1484+1), in_double, out_rezult, size_input_file / 2 - 1);


    for(i=0; i < size_input_file/2; i++)
        out[i] = (short int) out_rezult[i];

    if((fpw=fopen("C:\\Users\\Sergei\\Desktop\\filter\\muzic_rezult.bin", "w+b"))==NULL)
//    if((fpw=fopen("D:\\Projects\\Lab_6\\Hardware\\src\\filter\\muzic_rezult.bin", "w+b"))==NULL)
    {
        printf ("Cannot open file.\n");
        exit(1);
    }


    fwrite(out, sizeof(short int), size_input_file/2, fpw);


    fclose(fp);
    fclose(fpw);

    return;
}
